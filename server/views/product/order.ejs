<!DOCTYPE html>
<html>

<head>
    <title>CS</title>
    <link rel='stylesheet' href='/stylesheets/default.css' />
    <link rel='stylesheet' href='/stylesheets/navstyle.css' />
    <script src='/javascripts/fabric_min.js'></script>
    <style>
        .contents {
            margin-top: 100px;
            display: block;
            position: relative;
            margin-left: auto;
            margin-right: auto;
            width: 1500px;
            height: 640px;
            margin-bottom: 50px;

        }

        .custom_cont {
            float: left;
            width: 1097px;
            height: 100%;

            border-right: none;
            position: relative;
        }

        .sale_cont {
            float: right;
            width: 400px;
            height: 100%;
            border: 1px solid black;
        }

        #c {
            position: absolute;
            border: 1px solid black;
        }

        .all_btn {
            position: absolute;
            width: 70px;
            height: 240px;
            z-index: 10;
            right: 25px;
            top: 30px;
        }

        .float_btn {
            position: relative;
            display: block;
            border-radius: 50%;
            background: white;
            height: 70px;
            width: 70px;
            margin-bottom: 10px;
            box-shadow: 0px 4px 8px 0 rgba(0, 0, 0, 0.2);
        }

        .float_btn a {
            position: absolute;
            width: 100%;
            text-align: center;
            line-height: 70px;
            display: block;
            cursor: pointer;
        }

        .float_btn label {
            position: absolute;
            width: 100%;
            text-align: center;
            line-height: 70px;
            display: block;
            cursor: pointer;
        }

        .add_picture {
            opacity: 0;
            width: 100%;
            position: absolute;
            line-height: 70px;
            z-index: 2;
        }


        .float_btn:hover {
            background-color: #FFC000;
        }

        .float_btn:hover a {
            color: white;
        }

        .float_btn:hover label {
            color: white;
        }


        #first {
            opacity: 1;
            visibility: visible;
            position: absolute;
        }

        #second {
            opacity: 0;
            visibility: none;
            position: absolute;
        }
    </style>
</head>

<body>
    <%- include("../head/nav") %>
    <div class="contents">
        <div class="custom_cont" id="custom_cont">
            <div class="all_btn">
                <li>
                    <div class="float_btn">
                        <label for="select_pic">사진추가</label>
                        <input name="select_pic" type="file" class="add_picture" />
                    </div>
                </li>
                <li>
                    <div class="float_btn">
                        <a for="add_text_btn" onclick="addText()">글자추가</a>
                    </div>
                </li>
                <li>
                    <div class="float_btn">
                        <a for="add_text_btn" onclick="Selection_Mode()">선택하기</a>
                    </div>
                </li>
                <li>
                    <div class="float_btn">
                        <a for="add_text_btn" onclick="DrawingMode()">그리기</a>
                    </div>
                </li>
                <li>
                    <div class="float_btn">
                        <a class="remove_text_btn" onclick="delete_obj()">삭제</a>
                    </div>
                </li>
            </div>
            <canvas id="c" width="1097px" height="640px"></canvas>
        </div>


        <div class="sale_cont">
            <div id="first">
                <div class="order_pro">
                    <h3>주문하기</h3>
                    <hr>
                    <div>가격 : <sapn>1000</sapn>원</div>
                    <div>사이즈</div>
                    <button>주문하기</button>
                    <button>장바구니</button>
                </div>
            </div>

            <div id="second">
                <div class="option">
                    <strong>Option</strong>
                    <div class="block">
                        <label for="textSize" class="opt-title">Font size</label>
                        <input id="size_con" class="text_con" type="range" name="textSize" min="10" max="30" value="20"
                            data-sizing="px" />
                    </div>
                    <div class="block">
                        <label for="fontWeight" class="opt-title">TextStyle</label>
                        <input id="weight_con" class="style_con" type="range" name="fontWeight" min="100" max="900"
                            value="100" step="100" />
                    </div>
                    <div class="block">
                        <label for="mainColor" class="opt-title">Main Color</label>
                        <input id="color_con" class="color_con" type="color" name="mainColor" value="#ffc600">
                    </div>
                    <div class="block">
                        <label for="backColor" class="opt-title">background Color</label>
                        <input id="back_con" class="back_con" type="color" name="backColor" value="#000000FF" />
                        <input type="checkbox" id="back_check" name="backColor" />
                    </div>
                    <div class="block">
                        <label for="opacitys" class="opt-title">Opacity</label>
                        <input id="opa_con" class="style_con" type="range" name="opacitys" min="0.1" max="1" value="1"
                            step="0.1" />
                    </div>
                    <div class="block">
                        <label for="bordres" class="opt-title">border</label>
                        <select class="borders" id="border_con" name="borders">
                            <option value="none">none</option>
                            <option value="solid">solid</option>
                            <option value="dotted">dotted</option>
                            <option value="dashed">deshed</option>
                            <option value="double">double</option>
                            <option value="groove">groove</option>
                            <option value="ridge">ridge</option>
                            <option value="inset">inset</option>
                            <option value="outset">outset</option>
                            <option value="inherit">inherit</option>
                        </select>
                        <input type="range" id="border_weigth_con" class="borders" min="0" max="10" value="0" step="1"
                            data-sizing="px" />
                        <input type="color" id="border_color_con" class="borders" />

                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<script>
    var canvas = new fabric.Canvas('c');

    function addText() {
        const canvCenter = canvas.getCenter();
        var textBox = new fabric.Textbox('텍스트', {
            font_size: 20,
            left: canvCenter.left,
            top: canvCenter.top,
            originX: 'center',
            originY: 'center',

        });
        canvas.add(textBox).setActiveObject(textBox);
    }

    function delete_obj() {
        var activeObject = canvas.getActiveObject();
        
        if(confirm('Are you sure?')){
            if(activeObject._objects){
                var objectsInGroup = activeObject.getObjects();
                objectsInGroup.forEach(function(objects){
                    canvas.remove(objects);
                })
            }else{
                canvas.remove(activeObject);
            }
        }
    }

    function Selection_Mode() {
        canvas.isDrawingMode = false;
    }

    function DrawingMode() {
        canvas.isDrawingMode = true;
    }

    canvas.on('mouse:down', function (e) {

        if (e.target) {
            if(e.target.type == 'textbox'){
            let aa = document.getElementById('first');
            let bb = document.getElementById('second');
            aa.style.opacity = "0";
            aa.style.visibility = "none";
            bb.style.opacity = "1";
            bb.style.visibility = "visible";
            bb.style.pointerEvents = "auto";
            }
        }
        else {
            let aa = document.getElementById('first');
            let bb = document.getElementById('second');
            aa.style.opacity = "1";
            aa.style.visibility = "visible";
            bb.style.opacity = "0";
            bb.style.visibility = "none";
            bb.style.pointerEvents = "auto";
        }
    })
</script>